#!/usr/bin/bash

# to use your own data, this automatically sets USER to be your username
#USER=${USER:-`whoami`}
USER=`whoami`
# and this is the path to where your data was placed by the make_mfccs script
#DATA=${DATA:-/Volumes/Network/courses/sp/data_upload}

# later, to use another user's data, for example "simonk"
# USER=simonk
# and to access all data from all years, use this path
DATA=../data_local

PRUNING=${1:-0.0}
# shopt -s extglob
LMSF=${2:-1.0}

for F in `ls ${DATA}/mfcc/test_seq/*.mfcc`
do
 FF=`basename $F .mfcc`

 # echo
 # echo Doing $F

 HVite -T 1 -C ../resources/CONFIG -p $PRUNING\
	-d ../models/hmm1 \
	-l ../rec \
  -s $LMSF \
	-w ../resources/digit_sequence_grammar_as_network \
	../resources/dictionary \
	../resources/seq_word_list \
	$F

done
# Added the contect from seq_result
HResults -p -t -e s junk -z s \
 -I ${DATA}/lab/test_seq/${USER}_test_seq.mlf \
 ../resources/seq_word_list \
 ../rec/*

 rm -f ../models/hmm*/*
 rm -f ../rec/*
